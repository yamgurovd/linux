# Настройка туннелирования через SSH с помощью MobaXterm для доступа к Kubernetes Dashboard

---

## Краткое содержание инструкции

В данной инструкции описывается процесс настройки SSH-туннелирования с помощью MobaXterm для безопасного доступа к
Kubernetes Dashboard, развернутому на ноутбуке, с другого компьютера по локальной сети. Это позволяет управлять
кластером Kubernetes через веб-интерфейс, не открывая дополнительные порты наружу.

---

## Краткое содержание происходящего

1. **Установка и запуск MobaXterm**  
   Скачивается и запускается MobaXterm на компьютере (при необходимости через Wine).

2. **Подключение по SSH к ноутбуку, где развернут Kubernetes**  
   Устанавливается SSH-соединение с ноутбуком.

3. **Запуск Kubernetes Dashboard на ноутбуке**  
   На ноутбуке запускается proxy для Dashboard.

4. **Настройка SSH-туннеля в MobaXterm**  
   В MobaXterm настраивается перенаправление локального порта на порт Dashboard на ноутбуке.

5. **Открытие Dashboard в браузере**  
   Dashboard становится доступен по адресу `https://localhost:<порт>` на компьютере.

---

## Что происходит в целом

Инструкция позволяет безопасно получить доступ к Kubernetes Dashboard с другого устройства, используя SSH-туннель. Это
защищает трафик и не требует пробрасывания портов на роутере или открытого доступа к Dashboard из внешней сети.

---

## Таблица команд и действий

| Действие/Команда                              | Описание                                                                   |
|-----------------------------------------------|----------------------------------------------------------------------------|
| Скачать MobaXterm                             | Загрузка программы для организации SSH-туннелей.                           |
| `ssh d@192.168.0.101`                         | Пример подключения по SSH к ноутбуку (замените на свой IP и пользователя). |
| `microk8s dashboard-proxy`                    | Запуск proxy для Kubernetes Dashboard на ноутбуке.                         |
| Настройка SSH-туннеля в MobaXterm             | Перенаправление локального порта на порт Dashboard на ноутбуке.            |
| Открытие `https://localhost:10443` в браузере | Доступ к Dashboard через туннель.                                          |

---

## Пояснения

- **MobaXterm** — удобная программа для работы с SSH и настройки туннелей.
- **SSH-туннель** — защищённое соединение, позволяющее получить доступ к сервисам на удалённой машине через локальный
  порт.
- **Kubernetes Dashboard** — веб-интерфейс для управления кластером Kubernetes.
- **Proxy** — позволяет обращаться к Dashboard только с localhost, что повышает безопасность.

---

# Подробная инструкция

---

### 1. Скачайте и установите MobaXterm

- Перейдите на сайт: [https://mobaxterm.mobatek.net/download.html](https://mobaxterm.mobatek.net/download.html)
- Если вы используете Linux, запустите программу через Wine:

```shell
cd /home/d/Documents/BFS/MobaXterm_Portable_v25.2
wine MobaXterm_Personal_25.2.exe
```

*Запуск производится из той же директории, где находится файл `.exe`.*

---

### 2. Подключитесь по SSH к ноутбуку, где развернут Kubernetes

В терминале выполните команду:

```shell
ssh d@192.168.0.101
```

![Dbeaver](/course_helpers/9%20Docker%20и%20деплой%20проекта/cuber30.png)
где:

- `d` — имя пользователя на ноутбуке,
- `192.168.0.101` — IP-адрес ноутбука.

---

### 3. Запустите Kubernetes Dashboard на ноутбуке

Выполните команду:

```shell
microk8s dashboard-proxy
```

![Dbeaver](/course_helpers/9%20Docker%20и%20деплой%20проекта/cuber31.png)
В ответ будет выведен адрес Dashboard, например:  
`http://127.0.0.1:10443`

---

### 4. Настройте SSH-туннель в MobaXterm

1. Откройте MobaXterm.
2. Создайте новую SSH-сессию на ноутбук (`d@192.168.0.101`).
3. Перейдите во вкладку **Network** → **SSH tunnels**.
4. Добавьте локальный порт (например, 10443), который будет перенаправляться на `127.0.0.1:10443` на ноутбуке.
    - **Source port**: 10443
    - **Destination**: 127.0.0.1:10443
    - **Remote server**: 192.168.0.101
5. Сохраните настройки и подключитесь.
   ![Dbeaver](/course_helpers/9%20Docker%20и%20деплой%20проекта/cuber32.png)

---

### 5. Откройте Kubernetes Dashboard в браузере

На компьютере, где настроен туннель, откройте браузер и перейдите по адресу:

```shell
https://localhost:10443
```

![Dbeaver](/course_helpers/9%20Docker%20и%20деплой%20проекта/cuber33.png)
![Dbeaver](/course_helpers/9%20Docker%20и%20деплой%20проекта/cuber34.png)
При необходимости подтвердите исключение безопасности (Dashboard использует самоподписанный сертификат).

---

### 6. Итог

- Вы настроили защищённый доступ к Kubernetes Dashboard через SSH-туннель.
- Теперь можно управлять кластером Kubernetes через веб-интерфейс с любого компьютера в сети.

---

## Что было проделано

- Скачан и запущен MobaXterm.
- Установлено SSH-соединение с ноутбуком.
- Запущен proxy Kubernetes Dashboard.
- Настроен SSH-туннель для перенаправления порта.
- Получен безопасный доступ к Dashboard через браузер.

