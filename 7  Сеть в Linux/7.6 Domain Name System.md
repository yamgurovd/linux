# 7.6 Domain Name System

---
##Конспект

#### Основные команды и понятия для работы с DNS в Linux

| Команда / Понятие                                       | Результат / Описание                                           | Пояснение и пример использования                                                                                   |
|--------------------------------------------------------|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| `/etc/hosts`                                           | Локальный файл для сопоставления имён с IP-адресами           | Добавление записей вида `192.168.1.10 db-server` позволит вызывать хост по имени без использования DNS-сервера.       |
| `/etc/nsswitch.conf`                                   | Файл конфигурации порядка разрешения имён                      | Строка `hosts: files dns` означает сначала проверку `/etc/hosts`, потом DNS. Можно менять порядок для тестов.          |
| `/etc/resolv.conf`                                     | Файл настройки DNS-серверов                                    | Добавьте строки `nameserver 8.8.8.8` или `nameserver 192.168.1.100` для указания DNS-серверов, используемых системой. |
| `ping <hostname_or_ip>`                                | Проверка доступности хоста или IP                              | Проверяет доходят ли пакеты до целевого хоста, например `ping db-server` или `ping 192.168.1.10`.                      |
| `nslookup <hostname>`                                  | Запрос разрешения имени у DNS сервера                          | Отображает IP-адрес, связанный с именем, а также использованный DNS-сервер.                                          |
| `dig <hostname> [тип_записи]`                         | Гибкий DNS-запрос с выводом подробной информации               | Пример: `dig www.example.com A` покажет IPv4 адреса; `dig www.example.com AAAA` — IPv6.                                |
| `host <hostname>`                                      | Простая утилита для проверки DNS-разрешения                    | Быстрый способ узнать IP по имени, например: `host db-server`                                                        |
| Тип записи A                                           | Соответствие имени хоста IPv4-адресу                           | Используется для сопоставления имён с IPv4 адресами.                                                                 |
| Тип записи AAAA                                        | Соответствие имени хоста IPv6-адресу                           | Аналогично A, но для IPv6 адресов.                                                                                   |
| Тип записи CNAME                                       | Псевдонимы для доменных имён                                   | Позволяет указать, что одно имя является алиасом другого, например: `www -> webserver1`.                              |
| `search <domain>` в /etc/resolv.conf                   | Домены для поиска при разрешении коротких имён                 | Позволяет обращаться к хостам без полного имени, как `db-server` вместо `db-server.corp.example.com`.                  |
| Иерархия доменных имён                                | Структура из доменов и поддоменов                              | Пример: `app.corp.example.com` — поддомен `app` внутри `corp.example.com`.                                            |

---

### Краткая инструкция по настройке DNS на Linux

1. **Добавление локальных записей в /etc/hosts**  
   Отредактируйте файл `/etc/hosts`, добавив строки вида:  
```text
192.168.1.10 db-server
192.168.1.11 web-server
```
Это поможет локально разрешать имена без обращения к DNS.

2. **Настройка порядка разрешения имён**  
Проверьте файл `/etc/nsswitch.conf`, строка должна быть примерно:  
```text
hosts: files dns
```
Это поможет локально разрешать имена без обращения к DNS.

2. **Настройка порядка разрешения имён**  
Проверьте файл `/etc/nsswitch.conf`, строка должна быть примерно:  

```text
nameserver 8.8.8.8
nameserver 192.168.1.100
search corp.example.com
```

Опция `search` позволяет резолвить короткие имена в указанном домене.

4. **Проверка работы DNS**  
- Используйте `ping db-server` для проверки работы имя → IP.  
- Для более детальных данных используйте `nslookup db-server` или `dig db-server`.  
- Если необходимо проверить псевдонимы — используйте `dig db-server CNAME`.

5. **Использование доменных имён**  
Помните, что DNS структурирован как иерархия: корневой домен, домен второго уровня (example.com), поддомены (app.example.com).  
Для корпоративных сетей часто настраивают внутренние домены с отдельными DNS серверами.

---

Если хотите, могу подготовить примеры конфигураций файлов `/etc/hosts`, `/etc/resolv.conf` и команды для диагностики с разъяснениями.



### Введение
- Цель лекции: понимание основ DNS для новичков в Linux.
- Основные понятия и команды для управления DNS на Linux хостах.

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS.png)

### Основные понятия

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS2.png)

- DNS (Domain Name System) - система для преобразования имен хостов в IP адреса.
- IPv4 - Пример: 192.168.1.10, 192.168.1.11.
- Практический пример использования: удобство использования имён хостов вместо IP адресов (например, db-server вместо 192.168.1.11).

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS3.png)

### Настройка DNS на локальном компьютере

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS4.png)
![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS5.png)

- Добавление записей в файл /etc/hosts для разрешения имен.
- Приоритет разрешения в /etc/nsswitch.conf (сначала проверяется локальный файл hosts, потом DNS).
- Пример изменения: по умолчанию - files dns, можно изменить порядок.
### DNS Сервера

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS6.png)
![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS7.png)

- DNS сервера - управление разрешениями имён для множества хостов.
- Настройка DNS сервера в файле /etc/resolv.conf (например, nameserver 192.168.1.100).
- Публичные DNS сервера для доступа в Интернет (например, Google DNS 8.8.8.8).
### Доменные имена

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS8.png)
![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS9.png)


- Иерархия доменных имен (например, www.example.com - сабдомен www доменного имени example.com).
- Внутренняя структура доменов в организациях (например, app.corp.example.com).
### Настройка поиска доменов

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS10.png)

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS11.png)

- Добавление параметра search в /etc/resolv.conf для упрощения доступа к внутренним ресурсам.
- Пример: search corp.example.com позволяет обращаться к хостам по коротким именам.
### Типы DNS записей

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS12.png)
![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS13.png)
- A - соответствие между именем хоста и IPv4.
- AAA (Quad-A) - соответствие между именем хоста и IPv6.
- CNAME - сопоставление псевдонимов (aliases) для имён хостов.
### Инструменты для проверки DNS

![BPMN-схема бизнес-процесса](/7%20%20Сеть%20в%20Linux/DNS14.png)

- ping - проверка доступности хоста.
 nslookup и dig - запрос информации у DNS серверов.
- host - базовая проверка DNS разрешений.

---